<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Treasure - JS SDK Test Page</title>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
    <script>
      (function(n,c){
        if (c[n] === void 0) {

          c[n] = function () {
            c[n].clients.push(this);
            this._init = [arguments];
          };
          c[n].clients = [];

          var action = function(method){
            return function () {
              this['_'+method] = this['_'+method] || [];
              this['_'+method].push(arguments);
              return this;
            };
          };

          var methods = ['addRecord', 'set', 'trackEvent', 'trackPageview'];
          for (var i = 0; i < methods.length; i++){
            var method = methods[i];
            c[n].prototype[method] = action(method);
          }

          setTimeout(function () {
            var s = document.createElement('script');
            s.type = 'text/javascript';
            s.async = !0;
            s.src = '/dist/td.js';

            var t = document.getElementsByTagName('script')[0];
            t.parentNode.insertBefore(s,t);
          }, 5000);

        }
      })('Treasure', this);

      // Configure the Treasure object with your database and API Key
      var treasure = new Treasure({
          database: "test_db_1",
          writeKey: "91/96da3cfb876cc50724d0dddef670d95eea2a0018", // required for sending events
          host: "in-staging.treasuredata.com"
      });
      treasure.trackPageview();

    </script>
</head>
<body>

<h1>Obtrusive JavaScript</h1>
<a href="http://www.google.com" onclick="return treasure.trackExternalLink(this, 'foo', {});">Click me!</a>

<form method="POST" action="http://foo.com" onsubmit="return treasure.trackExternalLink(this, 'foo', {});">
    <input type="submit" value="submit">
</form>

<h1>Unobtrusive jQuery</h1>
<a href="http://www.google.com" class="something">Click me!</a>

<form class="something" method="POST" action="http://foo.com" >
    <input type="submit" value="submit">
</form>

<script>
    $("a.something").click(function(){
        return treasure.trackExternalLink(this, "foo", {});
    });

    $("form.something").submit(function(){
        return treasure.trackExternalLink(this, "foo", {});
    })
</script>

<h1>Unobtrusive JavaScript</h1>

<a href="http://www.google.com" id="link">Click me!</a>

<form id="form" method="POST" action="http://foo.com" >
    <input type="submit" value="submit">
</form>

<script>
    document.getElementById("link").onclick = function(){
        return treasure.trackExternalLink(this, "foo", {});
    };
    document.getElementById("form").onsubmit = function(){
        return treasure.trackExternalLink(this, "foo", {});
    }
</script>

<h1>With my own timeout callback</h1>
<a href="http://www.google.com" id="link-2">Click me!</a>

<form id="form-2" method="POST" action="http://foo.com" >
    <input type="submit" value="submit">
</form>
<script>
    $("a#link-2").click(function(){
        return treasure.trackExternalLink(this, "foo", {}, 0, function(){console.log("HI")});
    });

    $("form#form-2").submit(function(){
        return treasure.trackExternalLink(this, "foo", {}, 0, function(){console.log("HI")});
    })
</script>
</body>
</html>
